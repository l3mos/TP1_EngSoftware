<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Produtos</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="produtos.css">
    <script defer src="produtos.js"></script>
</head>

<body>
    <header>
        <h1>Produtos</h1>
        <nav>
            <ul>
                <li><a href="../gerente/pag_inicial_gerente.html">Início</a></li>
                <li><a href="produtos.html">Produtos</a></li>
                <li><a href="../notificacoes/notificacoes.html">Notificações</a></li>
                <li><a href="../gerente/vendas.html">Vendas</a></li>
                <!-- <li><a href="../vendas/vendas.html">Vendas</a></li> -->
                <li><a href="../register/register.html">Cadastrar Funcionário</a></li>
                <li><a href="../login/login.html">Sair</a></li>
            </ul>
        </nav>
    </header>

    <section id="vendas">
        <h2>Produtos Disponíveis</h2>
        <table id="tabela-vendas" width="100%">
            <tr>
                <td>Produto</td>
                <td>Preço</td>
                <td>Quantidade</td>
            </tr>
        </table>
    </section>

    <footer>
        <p class="copyright-text">© 2024 GerCompras. Todos os direitos reservados.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabelaProdutos = document.getElementById('tabela-vendas');

            // Abrir ou criar o banco de dados
            const request = window.indexedDB.open('produtosDB', 1);

            // Lidar com o evento de sucesso da abertura do banco de dados
            request.onsuccess = (event) => {
                console.log('Banco de dados aberto com sucesso');
                atualizarTabelaVendas();
            };

            // Lidar com o evento de falha na abertura do banco de dados
            request.onerror = (event) => {
                console.error('Erro ao abrir o banco de dados:', event.target.error);
            };

            // Função para atualizar a tabela de vendas
            function atualizarTabelaVendas() {
                const transaction = request.result.transaction(['produtos'], 'readonly');
                const objectStore = transaction.objectStore('produtos');
                const getRequest = objectStore.getAll();

                getRequest.onsuccess = (event) => {
                    const produtos = event.target.result;

                    // Limpar tabela antes de atualizar
                    tabelaProdutos.innerHTML = `
                        <tr>
                            <td>Produto</td>
                            <td>Preço</td>
                            <td>Quantidade</td>
                        </tr>
                    `;

                    // Adicionar produtos à tabela
                    produtos.forEach(produto => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${produto.nome}</td>
                            <td>${produto.preco}</td>
                            <td>${produto.quantidade}</td>
                        `;
                        tabelaProdutos.appendChild(tr);
                    });
                };

                getRequest.onerror = (event) => {
                    console.error('Erro ao buscar produtos:', event.target.error);
                };
            }

        });
    </script>
</body>

</html>